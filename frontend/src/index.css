/* ===================================================================
   CineHub UI — TailwindCSS Global (Unified + Extended)
   Targets: Desktop / Tablet / Mobile
   Principles: responsive, a11y, motion-safe, Netflix-like polish
   =================================================================== */

@tailwind base;
@tailwind components;
@tailwind utilities;

/* ================================================================
   1) Base tokens, themes (dark default) & primitives
   --------------------------------------------------------------- */
@layer base {
  :root {
    /* Color tokens (OKLCH for consistent contrast) */
    --bg: oklch(14% 0.02 261);           /* near-black */
    --bg-elev: oklch(18% 0.02 261);
    --card: oklch(20% 0.02 261);
    --muted: oklch(62% 0.03 261 / .72);
    --text: oklch(96% 0.02 261);
    --text-dim: oklch(88% 0.02 261);
    --border: oklch(28% 0.03 261);

    /* Accent: red/rose Netflix-like */
    --accent: oklch(62% 0.24 27);
    --accent-700: oklch(54% 0.20 27);
    --accent-800: oklch(44% 0.18 27);

    /* Semantic helpers */
    --success: oklch(72% 0.16 150);
    --warning: oklch(76% 0.14 80);
    --danger:  oklch(65% 0.20 27);

    /* Effects */
    --ring: oklch(74% 0.12 27 / .35);
    --shadow: 0 10px 30px rgb(0 0 0 / .35);

    /* Radii */
    --radius: 14px;
    --radius-xl: 18px;
    --radius-2xl: 22px;

    /* Container widths */
    --container: 72rem;       /* 1152px */
    --container-wide: 80rem;  /* 1280px */
  }

  /* Light theme (tùy chọn): áp dụng khi data-theme="light" trên <html> hoặc <body> */
  :root[data-theme="light"] {
    --bg: oklch(98% 0.02 261);
    --bg-elev: oklch(96% 0.02 261);
    --card: oklch(98% 0.02 261);
    --muted: oklch(32% 0.03 261 / .72);
    --text: oklch(16% 0.02 261);
    --text-dim: oklch(34% 0.02 261);
    --border: oklch(84% 0.03 261);
    --ring: oklch(54% 0.12 27 / .35);
    --shadow: 0 10px 24px rgb(0 0 0 / .06);
  }

  html { color-scheme: dark; }
  html[data-theme="light"] { color-scheme: light; }

  html, body, #root { height: 100%; }
  body {
    background: var(--bg);
    color: var(--text);
    @apply antialiased;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
    text-rendering: optimizeLegibility;
  }

  ::selection { background: color-mix(in oklab, var(--accent) 40%, black); color: white; }
  img, video { max-width: 100%; height: auto; display: block; }
  *, *::before, *::after { box-sizing: border-box; }
  html, body { overflow-x: hidden; }

  /* Focus ring (a11y) */
  :focus-visible { outline: none; box-shadow: 0 0 0 2px var(--ring); }

  /* Chrome autofill (login/register) */
  input:-webkit-autofill,
  textarea:-webkit-autofill,
  select:-webkit-autofill {
    -webkit-box-shadow: 0 0 0 30px #0a0a0a inset !important;
    -webkit-text-fill-color: #e5e7eb !important;
    caret-color: #e5e7eb !important;
  }
  :root[data-theme="light"] input:-webkit-autofill,
  :root[data-theme="light"] textarea:-webkit-autofill,
  :root[data-theme="light"] select:-webkit-autofill {
    -webkit-box-shadow: 0 0 0 30px #ffffff inset !important;
    -webkit-text-fill-color: #111827 !important;
    caret-color: #111827 !important;
  }

  /* Number input spinner */
  input[type="number"]::-webkit-outer-spin-button,
  input[type="number"]::-webkit-inner-spin-button { -webkit-appearance: none; margin: 0; }
  input[type="number"] { -moz-appearance: textfield; }

  /* Motion preferences */
  @media (prefers-reduced-motion: reduce) {
    * { animation-duration: .001ms !important; animation-iteration-count: 1 !important; transition-duration: .001ms !important; scroll-behavior: auto !important; }
  }

  /* Scrollbar (WebKit + Firefox) */
  *::-webkit-scrollbar { width: 10px; height: 10px; }
  *::-webkit-scrollbar-thumb { background: color-mix(in oklab, white 12%, transparent); border-radius: 999px; }
}

/* ================================================================
   2) Keyframes & utilities (animations, helpers)
   --------------------------------------------------------------- */
@layer utilities {
  @keyframes fade-up { from { opacity:0; transform: translateY(8px) scale(.98); } to { opacity:1; transform: none; } }
  @keyframes fade-in { from { opacity:0 } to { opacity:1 } }
  @keyframes pop { 0% { transform: scale(.96) } 100% { transform: scale(1) } }
  @keyframes shimmer { 0% { background-position: -200% 0 } 100% { background-position: 200% 0 } }

  .animate-fade-up { animation: fade-up .35s ease both; }
  .animate-fade-in { animation: fade-in .25s ease both; }
  .animate-pop { animation: pop .15s ease both; }
  .animate-shimmer {
    background: linear-gradient(90deg, transparent, rgb(255 255 255 / .05), transparent);
    background-size: 200% 100%; animation: shimmer 1.1s linear infinite;
  }

  /* Scrollbar thin helper */
  .scrollbar-thin { scrollbar-width: thin; scrollbar-color: rgb(39 39 42) transparent; }
  .scrollbar-thin::-webkit-scrollbar { width: 8px; height: 8px; }
  .scrollbar-thin::-webkit-scrollbar-track { background: transparent; }
  .scrollbar-thin::-webkit-scrollbar-thumb { background-color: rgb(39 39 42); border-radius: 9999px; }

  /* Skeleton */
  .skeleton {
    position: relative; overflow: hidden;
    background: linear-gradient(90deg, rgba(24,24,27,.6), rgba(39,39,42,.6), rgba(24,24,27,.6));
    background-size: 200% 100%;
    animation: shimmer 1.2s infinite;
  }

  /* Small helpers */
  .shadow-card { box-shadow: var(--shadow); }
  .glass { background: rgb(255 255 255 / .06); border: 1px solid var(--border); -webkit-backdrop-filter: blur(8px); backdrop-filter: blur(8px); }
  .ring-accent { box-shadow: 0 0 0 2px var(--ring); }
  .text-balance { text-wrap: balance; }
  .safe-pads { padding-inline: max(1rem, env(safe-area-inset-left)); }
  .clamp-2 { display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden; }
  .clamp-3 { display: -webkit-box; -webkit-line-clamp: 3; -webkit-box-orient: vertical; overflow: hidden; }

  /* Aspect helpers (for poster/video thumbnails) */
  .aspect-poster { position: relative; padding-bottom: calc(3/2 * 100%); } /* 2:3 */
  .aspect-16x9 { position: relative; padding-bottom: calc(9/16 * 100%); } /* 16:9 */
  .aspect-fill > * { position:absolute; inset:0; width:100%; height:100%; object-fit:cover; }
}

/* ================================================================
   3) Components (btn, card, grid, hero, row, table, toast, forms)
   --------------------------------------------------------------- */
@layer components {
  /* Containers */
  .container { max-width: var(--container); margin-inline: auto; padding-inline: 1rem; }
  .container-wide { max-width: var(--container-wide); margin-inline: auto; padding-inline: 1rem; }

  /* Buttons */
  .btn { @apply inline-flex items-center gap-2 rounded-md px-4 py-2 font-medium transition; background: var(--accent); color: white; }
  .btn:hover { filter: brightness(1.05); }
  .btn:active { transform: translateY(1px); }
  .btn:disabled { @apply opacity-50 cursor-not-allowed; }

  .btn-outline { @apply inline-flex items-center gap-2 rounded-md px-3 py-2 transition; border: 1px solid var(--border); color: var(--text); background: transparent; }
  .btn-outline:hover { background: color-mix(in oklab, white 4%, transparent); }

  .btn-ghost { @apply inline-flex items-center gap-2 rounded-md px-3 py-2 transition; background: transparent; color: var(--text); }
  .btn-ghost:hover { background: color-mix(in oklab, white 6%, transparent); }

  .btn-lg { @apply px-5 py-3 text-base; }
  .btn-sm { @apply px-2.5 py-1.5 text-sm; }
  .icon-btn { @apply inline-flex items-center justify-center rounded-full size-9; background: color-mix(in oklab, white 10%, transparent); }

  /* Legacy buttons (giữ tương thích) */
  .btn-primary { @apply inline-flex items-center justify-center gap-2 rounded-lg px-4 py-2 text-zinc-900 transition active:scale-[.99]; background: #e5e7eb; }
  .btn-muted { @apply inline-flex items-center justify-center gap-2 rounded-lg px-4 py-2 text-zinc-100 transition hover:bg-zinc-700 active:scale-[.99]; background: #27272a; }

  /* Cards */
  .card { background: var(--card); border: 1px solid var(--border); border-radius: var(--radius-xl); overflow: hidden; }
  .card-hover { transition: transform .25s ease, box-shadow .25s ease; }
  .card-hover:hover { transform: translateY(-2px) scale(1.03); box-shadow: var(--shadow); }
  .card-body { @apply p-4; }

  .badge { @apply inline-flex items-center rounded-full px-3 py-1 text-xs; background: color-mix(in oklab, white 8%, transparent); border: 1px solid var(--border); }

  /* Hero */
  .hero {
    position: relative; min-height: 360px;
    border: 1px solid var(--border); border-radius: var(--radius-2xl);
    overflow: hidden; background-size: cover; background-position: center;
  }
  .hero::after {
    content:""; position:absolute; inset:0; pointer-events:none;
    background:
      radial-gradient(1200px 300px at 10% 100%, rgb(11 11 18 / 0) 0%, rgb(11 11 18 / .8) 66%, rgb(11 11 18) 100%),
      linear-gradient(180deg, rgb(11 11 18 / 0), rgb(11 11 18 / .85) 60%, rgb(11 11 18) 92%);
  }
  .hero-mask { background-image: var(--hero-mask, linear-gradient(90deg, rgb(11 11 18 /.95), rgb(11 11 18 /.35) 55%, rgb(11 11 18 /.1))); }

  /* Rows (horizontal scrollers) */
  .row { position: relative; }
  .row-track { @apply flex gap-3 overflow-x-auto snap-x snap-mandatory scroll-smooth pb-2; }
  .row-item { @apply snap-start shrink-0; width: 150px; }
  .row-mask-l, .row-mask-r { pointer-events:none; position:absolute; top:0; height:100%; width:48px; }
  .row-mask-l { left:0; background: linear-gradient(90deg, var(--bg), transparent); }
  .row-mask-r { right:0; background: linear-gradient(270deg, var(--bg), transparent); }

  /* Grid helpers */
  .grid-5 { display:grid; gap:1.25rem; grid-template-columns:repeat(2, minmax(0,1fr)); }
  .grid-auto-fill { display:grid; grid-template-columns: repeat(auto-fill, minmax(180px, 1fr)); gap: 1rem; }

  /* Table */
  .table { @apply w-full text-sm; border-collapse: collapse; }
  .table th, .table td { @apply px-3 py-2; border-bottom: 1px solid var(--border); }
  .table tbody tr:hover { background: color-mix(in oklab, white 6%, transparent); }
  .table .btn-outline { padding: .35rem .5rem; border-radius: .6rem; }

  /* Forms */
  input, select, textarea {
    @apply rounded-md p-2;
    background: color-mix(in oklab, white 4%, transparent);
    border: 1px solid var(--border);
    color: var(--text);
    transition: box-shadow .15s ease, border-color .15s ease;
  }
  input[type="text"], input:not([type]) { @apply p-2; }
  input:focus, select:focus, textarea:focus {
    outline: none; box-shadow: 0 0 0 2px var(--ring);
    border-color: color-mix(in oklab, var(--accent) 50%, var(--border));
  }
  label { @apply text-sm; color: var(--text-dim); }

  /* Menu */
  .menu-item { @apply w-full flex items-center gap-2 px-3 py-2 rounded-lg text-sm text-white transition; }
  .menu-item:hover { background: color-mix(in oklab, white 6%, transparent); }

  /* KBD */
  .kbd { @apply bg-neutral-800 border border-neutral-700 rounded-md px-2 py-0.5 text-xs; }

  /* Pager */
  .pager { @apply flex items-center gap-3 mt-4; }
  .pager button[disabled] { @apply opacity-50 cursor-not-allowed; }

  /* Toasts */
  .toast { @apply fixed z-50 right-4 bottom-4 flex flex-col gap-2; }
  .toast-item {
    background: rgb(20 20 25 / .9); border: 1px solid var(--border);
    @apply px-3 py-2 rounded-md shadow;
  }

  /* Quick actions on cards */
  .card-title-overlay {
    position:absolute; inset:0; display:flex; flex-direction:column; justify-content:flex-end;
    gap:.5rem; padding:.5rem;
    background:linear-gradient(to top, rgb(0 0 0 /.72), rgb(0 0 0 / 0) 60%);
    opacity:0; transition:opacity .2s ease;
  }
  .card:hover .card-title-overlay { opacity:1; }
  .quick-actions { display:flex; gap:.5rem; }
  .quick-actions .qa {
    display:inline-flex; align-items:center; justify-content:center; width:32px; height:32px;
    border-radius:999px; background: rgb(255 255 255 /.14);
    -webkit-backdrop-filter: blur(6px); backdrop-filter: blur(6px);
  }
  .quick-actions .qa:hover { background: rgb(255 255 255 /.24); }

  /* Full-bleed sections */
  .full-bleed { width: 100vw; position: relative; left: 50%; right: 50%; margin-left: -50vw; margin-right: -50vw; }
}

/* ================================================================
   4) Responsive polish
   --------------------------------------------------------------- */

/* HERO: thấp ở mobile, tăng dần */
.hero{ min-height:240px; }
@media (min-width:640px){ .hero{ min-height:320px; } }     /* iPad dọc */
@media (min-width:768px){ .hero{ min-height:360px; } }     /* iPad ngang */
@media (min-width:1024px){ .hero{ min-height:420px; } }    /* Desktop ≥ lg */

/* Row spacing & item width theo breakpoint */
.row-track{ gap:.5rem; padding-inline:.25rem; }
.row-item{ width:128px; }
@media (min-width:360px){ .row-item{ width:136px; } }
@media (min-width:640px){ .row-item{ width:168px; } }
@media (min-width:768px){ .row-item{ width:180px; } }
@media (min-width:1280px){ .row-item{ width:200px; } }

/* List “Top trend / Tiếp tục xem” gọn ở mobile */
@media (max-width:639px){
  .list-compact > a{ padding:.375rem .5rem; }
  .list-compact img{ width:36px; height:52px; }
  .list-compact .text-sm{ font-size:.8rem; }
}

/* Button/tap target thân thiện mobile */
.btn{ padding:.5rem .8rem; min-height:40px; }
@media (min-width:640px){ .btn{ padding:.6rem 1rem; } }

/* Grid helpers: 5 cột desktop, co xuống ở tablet/mobile */
.grid-5{
  grid-template-columns:repeat(2, minmax(0,1fr));
}
@media (min-width:640px){ .grid-5{ grid-template-columns:repeat(3,1fr); } }
@media (min-width:1024px){ .grid-5{ grid-template-columns:repeat(4,1fr); } }
@media (min-width:1280px){ .grid-5{ grid-template-columns:repeat(5,1fr); } }

/* Subtle hero overlays — tone down a bit for readability */
.hero::after{
  content:'';
  position:absolute; inset:0; pointer-events:none;
  background: linear-gradient(180deg,
    rgba(0,0,0,0.00) 10%,
    rgba(0,0,0,0.35) 60%,
    rgba(0,0,0,0.60) 100%);
}
.hero .hero-mask{
  position:absolute; inset:0; pointer-events:none;
  background: linear-gradient(90deg,
    rgba(0,0,0,0.55) 0%,
    rgba(0,0,0,0.25) 35%,
    rgba(0,0,0,0.00) 65%);
}
